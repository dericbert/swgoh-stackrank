<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWGOH StackRank - Visual Editor</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>SWGOH StackRank Visual Editor</h1>
                <div class="header-actions">
                    <button id="btnAddCharacter" class="btn btn-success">
                        <span class="icon">+</span> Add Character
                    </button>
                    <button id="btnVisualize" class="btn btn-secondary">
                        <span class="icon">ðŸ“Š</span> Visualize
                    </button>
                    <button id="btnValidate" class="btn btn-secondary">
                        <span class="icon">âœ“</span> Validate
                    </button>
                    <button id="btnExport" class="btn btn-secondary">
                        <span class="icon">â¬‡</span> Export JSON
                    </button>
                    <button id="btnSave" class="btn btn-primary">
                        <span class="icon">ðŸ’¾</span> Save Changes
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Left Sidebar: Character Details -->
            <aside class="sidebar sidebar-left collapsed">
                <div class="sidebar-header">
                    <h2>Character Details</h2>
                    <button class="sidebar-toggle" id="toggleLeftSidebar" aria-label="Toggle Character Details" aria-expanded="false">
                        <span class="toggle-icon">â—€</span>
                    </button>
                </div>
                <div class="sidebar-subheader" id="characterIdLeft">
                    <span class="character-id-display">No character selected</span>
                </div>
                <div class="sidebar-content" id="characterDetails">
                    <div class="empty-state">
                        <p>Select a character to view details</p>
                    </div>
                </div>
                <div class="sidebar-footer">
                    <button class="btn btn-primary btn-update-character" id="btnUpdateCharacterLeft" onclick="updateCharacter()" disabled>
                        Update Character
                    </button>
                </div>
            </aside>

            <!-- Center: Tier Grid -->
            <section class="tier-grid-container">
                <div class="tier-grid-header">
                    <h2>Tier Grid</h2>
                    <div class="view-controls">
                        <label>
                            <input type="checkbox" id="chkIncludeSynergy">
                            Include Synergy
                        </label>
                        <label>
                            <input type="checkbox" id="chkIncludeOmicron">
                            Include Omicron
                        </label>
                        <select id="omicronTypeSelector" class="omicron-type-dropdown" multiple size="1">
                            <option value="GAC" selected>GAC</option>
                            <option value="TB" selected>TB</option>
                            <option value="TW" selected>TW</option>
                            <option value="Raid">Raid</option>
                            <option value="Conquest">Conquest</option>
                            <option value="GC">GC</option>
                        </select>
                        <button class="btn btn-secondary btn-small" id="btnFilter">
                            Filter Characters
                            <span class="filter-indicator" id="filterIndicator"></span>
                        </button>
                    </div>
                </div>
                
                <div class="tier-grid" id="tierGrid">
                    <!-- Tier columns will be generated dynamically -->
                </div>

                <div class="loading-overlay" id="loadingOverlay">
                    <div class="spinner"></div>
                    <p>Loading character data...</p>
                </div>
            </section>

            <!-- Right Sidebar: Synergy Editor -->
            <aside class="sidebar sidebar-right collapsed">
                <div class="sidebar-header">
                    <h2>Synergy Sets</h2>
                    <button class="sidebar-toggle" id="toggleRightSidebar" aria-label="Toggle Synergy Sets" aria-expanded="false">
                        <span class="toggle-icon">â–¶</span>
                    </button>
                </div>
                <div class="sidebar-subheader" id="characterIdRight">
                    <span class="character-id-display">No character selected</span>
                </div>
                <div class="sidebar-content" id="synergyEditor">
                    <div class="empty-state">
                        <p>Select a character to edit synergies</p>
                    </div>
                </div>
                <div class="sidebar-footer">
                    <button class="btn btn-primary btn-update-character" id="btnUpdateCharacterRight" onclick="updateCharacter()" disabled>
                        Update Character
                    </button>
                </div>
            </aside>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="statusMessage">Ready</span>
            </div>
            <div class="status-right">
                <span id="missingCharacters">No missing characters</span>
                <span class="separator">|</span>
                <span id="characterCount">0 characters</span>
                <span class="separator">|</span>
                <span id="validationStatus"></span>
            </div>
        </footer>

        <!-- Modal: Validation Results -->
        <div id="validationModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Validation Results</h3>
                    <button class="modal-close" onclick="closeValidationModal()">&times;</button>
                </div>
                <div class="modal-body" id="validationResults">
                    <!-- Validation results will be inserted here -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeValidationModal()">Close</button>
                </div>
            </div>
        </div>

        <!-- Modal: Add Character -->
        <div id="addCharacterModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Character</h3>
                    <button class="modal-close" onclick="closeAddCharacterModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="missingCharactersSection" style="display: none;">
                        <label class="form-label">Select from missing characters:</label>
                        <input type="text" id="missingCharacterSearch" class="form-input" placeholder="Search missing characters..." style="margin-bottom: 12px;">
                        <div id="missingCharactersList" class="missing-characters-list">
                            <!-- Missing characters will be inserted here -->
                        </div>
                        <div style="text-align: center; margin: 16px 0; color: var(--color-text-secondary);">â€” OR â€”</div>
                    </div>
                    <label class="form-label">Enter custom character ID:</label>
                    <input type="text" id="customCharacterId" class="form-input" placeholder="Uppercase letters, numbers, and underscores only">
                    <div class="form-help">Character ID must contain only uppercase letters, numbers, and underscores.</div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeAddCharacterModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="submitNewCharacter()" id="btnSubmitCharacter">Add Character</button>
                </div>
            </div>
        </div>

        <!-- Modal: Filter Characters -->
        <div id="filterModal" class="modal" style="display: none;">
            <div class="modal-content modal-content-wide">
                <div class="modal-header">
                    <h3>Filter Characters</h3>
                    <button class="modal-close" onclick="closeFilterModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="filter-group">
                        <div class="filter-group-header">
                            <h4>Categories</h4>
                            <div class="filter-operator-toggle">
                                <button type="button" class="btn btn-small operator-btn" id="operatorCategoriesAnd" onclick="setFilterOperator('Categories', 'AND')">AND</button>
                                <button type="button" class="btn btn-small operator-btn" id="operatorCategoriesOr" onclick="setFilterOperator('Categories', 'OR')">OR</button>
                            </div>
                        </div>
                        <div class="filter-checkboxes" id="filterCategories">
                            <!-- Category checkboxes will be inserted here -->
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-header">
                            <h4>Roles</h4>
                            <div class="filter-operator-toggle">
                                <button type="button" class="btn btn-small operator-btn" id="operatorRolesAnd" onclick="setFilterOperator('Roles', 'AND')">AND</button>
                                <button type="button" class="btn btn-small operator-btn" id="operatorRolesOr" onclick="setFilterOperator('Roles', 'OR')">OR</button>
                            </div>
                        </div>
                        <div class="filter-checkboxes" id="filterRoles">
                            <!-- Role checkboxes will be inserted here -->
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-header">
                            <h4>Alignments</h4>
                            <div class="filter-operator-toggle">
                                <button type="button" class="btn btn-small operator-btn" id="operatorAlignmentsAnd" onclick="setFilterOperator('Alignments', 'AND')">AND</button>
                                <button type="button" class="btn btn-small operator-btn" id="operatorAlignmentsOr" onclick="setFilterOperator('Alignments', 'OR')">OR</button>
                            </div>
                        </div>
                        <div class="filter-checkboxes" id="filterAlignments">
                            <!-- Alignment checkboxes will be inserted here -->
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-header">
                            <h4>Custom Character Categories</h4>
                            <div class="filter-operator-toggle">
                                <button type="button" class="btn btn-small operator-btn" id="operatorCustomCategoriesAnd" onclick="setFilterOperator('CustomCategories', 'AND')">AND</button>
                                <button type="button" class="btn btn-small operator-btn" id="operatorCustomCategoriesOr" onclick="setFilterOperator('CustomCategories', 'OR')">OR</button>
                            </div>
                        </div>
                        <div class="filter-checkboxes" id="filterCustomCategories">
                            <!-- Custom category checkboxes will be inserted here -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="btnFilterClear" onclick="clearFilterSelections()" disabled>Clear</button>
                    <button class="btn btn-secondary" onclick="closeFilterModal()">Close</button>
                    <button class="btn btn-primary" onclick="applyFilter()">Apply</button>
                </div>
            </div>
        </div>

        <!-- Modal: Tier Distribution Visualization -->
        <div id="tierDistributionModal" class="modal" style="display: none;">
            <div class="modal-content modal-content-wide">
                <div class="modal-header">
                    <h3>Tier Distribution</h3>
                    <button class="modal-close" onclick="closeTierDistributionModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="tier-distribution-controls">
                        <label class="checkbox-label">
                            <input type="checkbox" id="vizIncludeSynergy">
                            Include Synergy
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="vizIncludeOmicron">
                            Include Omicron
                        </label>
                        <select id="vizOmicronTypeSelector" class="omicron-type-dropdown" multiple size="1">
                            <option value="GAC" selected>GAC</option>
                            <option value="TB" selected>TB</option>
                            <option value="TW" selected>TW</option>
                            <option value="Raid">Raid</option>
                            <option value="Conquest">Conquest</option>
                            <option value="GC">GC</option>
                        </select>
                    </div>
                    <div id="tierDistributionChart" class="tier-distribution-chart">
                        <!-- Chart will be rendered here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeTierDistributionModal()">Close</button>
                </div>
            </div>
        </div>

        <!-- Tooltip for tier calculations -->
        <div id="tierTooltip" class="tier-tooltip" style="display: none;">
            <div class="tooltip-content"></div>
        </div>
    </div>

    <script src="editor.js"></script>
</body>
</html>
